# CDK Ansible by Rust

[![Crates.io][crates-badge]][crates-url]

[crates-badge]: https://img.shields.io/crates/v/cdk-ansible.svg
[crates-url]: https://crates.io/crates/cdk-ansible

`cdk-ansible` is a CDK (Cloud Development Kit) for Ansible, and inspired by AWS CDK.

While Ansible's `playbook` and `inventory` files are written in YAML format, managing YAML templating can be challenging.
`cdk-ansible` enables you to generate Ansible files using **Rust** as a type-safe programming language.

## Features

- `cdk-ansible` generates Ansible **Playbook** and **Inventory** files.

## Usage

### Init cdk-ansible project

Note: (Future feature) `cdk-ansible project` to create a new cdk-ansible's template project.

```txt
proj-root/
`-- Cargo.toml          ... workspace cargo
                            define `workspace.dependencies.cdk-ansible`.
```

### Create Ansible Module package for the workspace

```bash
cdk-ansible module --output-dir crates/ --module-name ansible.builtin.debug

# If you don't specify `--module-name`, all modules accessible from your ansible environment will be generated.
cdk-ansible module --output-dir crates/

# If you are using uv to manage your ansible project, specify the `--project` option.
uv --project /path/to/your/ansible-project run \
  cdk-ansible module --output-dir crates/ --module-name ansible.builtin.debug
```

```txt
proj-root/
|-- Cargo.toml
|-- crates/
|   |-- cdkam_ansible/  ... auto-generated by `cdk-ansible module` command
|   |   |-- Cargo.toml
|   |   `-- src/
|   |       |-- lib.rs
|   |       |-- m/ansible/builtin/debug.rs
|   |       `-- ...
```

```bash
cd proj-root
cargo run --package your-app -- synth
```

### Define your app

`your-app` project should be like [simple-sample](examples/simple-sample).

```txt
proj-root/
|-- Cargo.toml
|-- crates/
|   |-- cdkam_ansible/
|   |-- your-app/       ... Implement `cdk_ansible::Synthesizer` and call `cdk_ansible::run`
```
